#!/bin/sh

export PKGX_LIB="/usr/local/lib/pkgx"
export LIB="$PKGX_LIB/lib"
export CMD="$PKGX_LIB/commands"

. "$LIB/common.sh"
. "$LIB/backend.sh"

command="$1"
shift || true

case "$command" in
    add|install)
        exec sh "$CMD/add.sh" "$@"
        ;;
    aur|yay|aur-install)
        have pacman || ( printf "\033[1;32m───>\033[0m pkgx: AUR is only available on Arch-based systems\n" && exit 1 )
        have paru || ( printf "\033[1;32m───>\033[0m pkgx: yay is required for AUR installs\n" && exit 1 )
        exec sh "$CMD/aur-install.sh"
        ;;
    remove|rm)
        exec sh "$CMD/remove.sh" "$@"
        ;;
    menu)
        exec sh "$CMD/menu.sh" "$@"
        ;;
    ""|help|-h|--help)
        exec sh "$LIB/help.sh" "$@"
        ;;
    list)
        exec sh "$CMD/list.sh" "$@"
        ;;
    sync)
        exec sh "$CMD/sync.sh" "$@"
        ;;
    add-aur)
        exec sh "$CMD/aur-install.sh" "$@"
        ;;
    *)
        die "unknown command: $command"
        ;;
esac
